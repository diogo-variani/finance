<mat-toolbar>
  <button mat-icon-button (click)="newCategory()" matTooltip="Create a new category">
    <mat-icon>add</mat-icon>
  </button>
  <button mat-icon-button [disabled]="isCategorySelected" (click)="editCategory()" matTooltip="Edit the selected category">
    <mat-icon>edit</mat-icon>
  </button>
  <mat-divider class="style-fix" [vertical]="true"></mat-divider>
  <button mat-icon-button [disabled]="isCategorySelected" (click)="deleteCategoryTree()" matTooltip="Delete the whole tree selected">
    <mat-icon svgIcon="delete-tree"></mat-icon>
  </button>
  <button mat-icon-button [disabled]="isCategorySelected" (click)="deleteCategoryNode()" matTooltip="Delete the single node selected">
    <mat-icon svgIcon="delete-node"></mat-icon>
  </button>
</mat-toolbar>

<mat-card>
  <mat-card-title>Categories</mat-card-title> 
  <mat-card-content>
    
    <div>
      <mat-tree [dataSource]="dataSource" [treeControl]="treeControl" class="app-category-list">

        <mat-tree-node *matTreeNodeDef="let node" matTreeNodeToggle matTreeNodePadding>

          <button mat-icon-button disabled></button>
          <mat-checkbox class="checklist-leaf-node" [ngClass]="{'drop-above': dragNodeExpandOverArea === 'above' && dragNodeExpandOverNode === node,
                                'drop-below': dragNodeExpandOverArea === 'below' && dragNodeExpandOverNode === node,
                                'drop-center': dragNodeExpandOverArea === 'center' && dragNodeExpandOverNode === node}"
            [checked]="selection.isSelected(node.id)" (change)="selection.toggle(node.id);" draggable="true"
            (dragstart)="handleDragStart($event, node);" (dragover)="handleDragOver($event, node);"
            (drop)="handleDrop($event, node);" (dragend)="handleDragEnd($event);" [matTooltip]="node.description">{{node.title}}</mat-checkbox>


        </mat-tree-node>

        <!-- This is the tree node template for expandable nodes -->
        <mat-tree-node *matTreeNodeDef="let node; when: hasChild" matTreeNodePadding >

          <button mat-icon-button matTreeNodeToggle [attr.aria-label]="'toggle ' + node.filename">
            <mat-icon class="mat-icon-rtl-mirror">
              {{treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}
            </mat-icon>
          </button>

          <mat-checkbox [ngClass]="{'drop-above': dragNodeExpandOverArea === 'above' && dragNodeExpandOverNode === node,
                              'drop-below': dragNodeExpandOverArea === 'below' && dragNodeExpandOverNode === node,
                              'drop-center': dragNodeExpandOverArea === 'center' && dragNodeExpandOverNode === node}"
            draggable="true" (dragstart)="handleDragStart($event, node);" (dragover)="handleDragOver($event, node);"
            (drop)="handleDrop($event, node);" (dragend)="handleDragEnd($event);"
            [checked]="selection.isSelected(node.id)" (change)="selection.toggle(node.id);"
            [indeterminate]="descendantsPartiallySelected(node)" [matTooltip]="node.description">{{node.title}}
          </mat-checkbox>

        </mat-tree-node>

      </mat-tree>

      <span #emptyItem></span>
    </div>
  </mat-card-content>

</mat-card>